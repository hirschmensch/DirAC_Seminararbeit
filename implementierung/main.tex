In diesem Abschnitt wird beschrieben, wie der DirAC-Algorithmus in diesem Projekt implementiert wurde und bezieht sich dabei auf Abb. 2. Die Implementierung liegt als Script für GNU Octave vor und nutzt das \textit{signal}-Package. Der Code dafür ist zu großen Teilen direkt dem Buch \textit{Parametric Time-Frequency Domain Spatial Audio} ~\cite{spatial-book} von V. Pulkki entnommen.

\paragraph{Initialisierung}
Zu Beginn des Skriptes wird das Eingangssignal im B-Format erster Ordnung eingelesen. Dieses muss als \textit{.wav}-Datei vorliegen und genau vier Kanäle (in der Reihenfolge $w$, $x$, $y$, $z$) umfassen. Die Samplerate wird direkt aus dieser Datei ermittelt und als Variable \textit{fs} im Workspace von GNU Octave gespeichert.

Anschließend wird eine Liste von Lautsprecherpositionen eingelesen. Dabei handelt es sich entweder um die Lautsprecheranordnung des Wiedergabesystems (z.B. 12 Lautsprecher im Produktionsstudio des IEM Graz), oder um eine allgemeine t-Design Anordnung (in diesem Fall 48 Punkte für ein 9-Design). Die Koordinaten werden in sphärische Richtungen umgerechnet und daraus eine dreidimensionale VBAP-Matrix berechnet. Die Anzahl der Spalten dieser Matrix entspricht der Anzahl der eingelesenen Positionen (12 oder 48). Die Zeilenanzahl ist abhängig von der gewählten Richtungsauflösung (= $1^{\circ}$). Diese Matrix dient dazu, gerichtete Audiosignale auf die Ausgabekanäle (physische Lautsprecheranordnung oder allgemeines t-Design) abzubilden.

Im nächsten Schritt wird eine Sampling-Dekodermatrix \cite{ambi-book} aus den Lautsprecherrichtungen erzeugt, um die vier Eingangskanäle $w[n]$, $x[n]$, $y[n]$ und $z[n]$ des B-Format-Signals erster Ordnung auf eine Lautsprecheranordnung (12 oder 48 Kanäle) dekodieren zu können.
Dieser Vorgang lässt sich verbildlichen, als würden die Lautsprechersignale mit virtuellen Mikrofonen in Lautsprecherrichtung abgenommen werden. Dabei wird hier eine Supernieren-Richtcharakteristik für die virtuellen Mikrofone eingesetzt.

\paragraph{Verarbeitung im Frequenzbereich}
Das B-Format Eingangssginal wird in einer Schleife in zeitlichen Blöcken (Fenster) verarbeitet. Ein Fenster besteht dabei aus jeweils 512 Samples und wird in einer 1024-Punkt Fouriertransformation mit der Hilfe der Funktion \textit{fft()} in den Frequenzbereich transformiert. Die FFT-Länge wurde als doppelte Blocklänge gewählt um Aliasing zu vermeiden. Die zeitlichen Blöcke werden noch mit einem Hann-Fenster für die Resynthese beaufschlagt. Ein Hann-Fenster kann in GNU Octave mit der Funktion \textit{hann()}\footnote{alternativ: \textit{hanning()} (siehe \url{https://octave.sourceforge.io/octave/function/hanning.html}), abgeleitet aus der englischen Bezeichnung ``\textit{to hann}''} erzeugt, und einfach als Vektor mit den Zeitsignalen multipliziert werden.